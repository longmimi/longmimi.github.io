<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="1EB8XoOl0C"><meta name="google-site-verification" content="K7thEgdLm0UfRWJ5MGdF7sCcjClSzAlxFLPv2Oz5CGM"><title> webpack配置及优化 · LongTean's blog</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="webpack配置及优化 - LongTean"><meta name="keywords"><meta name="author" content="LongTean"><link rel="short icon" href="/uploads/touxiang.jpg"><link rel="stylesheet" href="https://bubuzou.oss-cn-shenzhen.aliyuncs.com/blog/202010/bubuzou.css"><link rel="search" type="application/opensearchdescription+xml" href="http://longmimi.github.io/atom.xml" title="LongTean's blog"><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script></head><body><header><div class="header row"> <a href="/" class="logo-link"><img src="/uploads/touxiang.jpg"></a><ul id="nav_list" class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" data-hover="博文" class="nav-list-link">博文</a></li><li class="nav-list-item"><a href="/archives/" target="_self" data-hover="归档" class="nav-list-link">归档</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div><div id="nav_btn" class="nav-btn"><span></span><span></span><span></span></div></div></header><div class="row scroll-con"><section class="container"><!-- for archive page--><div id="postAr" class="post"><article class="post-block"><h1 class="post-title">webpack配置及优化</h1><div class="post-info">2019-07-23</div><div class="post-content"><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>本地安装<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webapck webpack-cli --save-dev</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<h2 id="0-配置使用"><a href="#0-配置使用" class="headerlink" title="0 配置使用"></a>0 配置使用</h2><p>即默认配置，功能十分单一，会将<code>src</code>目录下的<code>index.js</code>文件打包到<code>dist</code>目录下，并命名为<code>main.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.js 文件内容</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'longtean'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js 文件内容</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="built_in">require</span>(<span class="string">'./test.js'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(str)</span><br><span class="line"></span><br><span class="line"><span class="comment">//main.js打包后输出内容</span></span><br><span class="line"></span><br><span class="line">!(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> t = &#123;&#125;;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params">r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (t[r]) <span class="keyword">return</span> t[r].exports;</span><br><span class="line">    <span class="keyword">var</span> o = (t[r] = &#123; <span class="attr">i</span>: r, <span class="attr">l</span>: !<span class="number">1</span>, <span class="attr">exports</span>: &#123;&#125; &#125;);</span><br><span class="line">    <span class="keyword">return</span> e[r].call(o.exports, o, o.exports, n), (o.l = !<span class="number">0</span>), o.exports;</span><br><span class="line">  &#125;</span><br><span class="line">  (n.m = e),</span><br><span class="line">    (n.c = t),</span><br><span class="line">    (n.d = <span class="function"><span class="keyword">function</span>(<span class="params">e, t, r</span>) </span>&#123;</span><br><span class="line">      n.o(e, t) || <span class="built_in">Object</span>.defineProperty(e, t, &#123; <span class="attr">enumerable</span>: !<span class="number">0</span>, <span class="attr">get</span>: r &#125;);</span><br><span class="line">    &#125;),</span><br><span class="line">    (n.r = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="string">"undefined"</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp;</span><br><span class="line">        <span class="built_in">Symbol</span>.toStringTag &amp;&amp;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">"Module"</span> &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">"__esModule"</span>, &#123; <span class="attr">value</span>: !<span class="number">0</span> &#125;);</span><br><span class="line">    &#125;),</span><br><span class="line">    (n.t = <span class="function"><span class="keyword">function</span>(<span class="params">e, t</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> ((<span class="number">1</span> &amp; t &amp;&amp; (e = n(e)), <span class="number">8</span> &amp; t)) <span class="keyword">return</span> e;</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">4</span> &amp; t &amp;&amp; <span class="string">"object"</span> == <span class="keyword">typeof</span> e &amp;&amp; e &amp;&amp; e.__esModule) <span class="keyword">return</span> e;</span><br><span class="line">      <span class="keyword">var</span> r = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        (n.r(r),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(r, <span class="string">"default"</span>, &#123; <span class="attr">enumerable</span>: !<span class="number">0</span>, <span class="attr">value</span>: e &#125;),</span><br><span class="line">        <span class="number">2</span> &amp; t &amp;&amp; <span class="string">"string"</span> != <span class="keyword">typeof</span> e)</span><br><span class="line">      )</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> e)</span><br><span class="line">          n.d(</span><br><span class="line">            r,</span><br><span class="line">            o,</span><br><span class="line">            <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">return</span> e[t];</span><br><span class="line">            &#125;.bind(<span class="literal">null</span>, o)</span><br><span class="line">          );</span><br><span class="line">      <span class="keyword">return</span> r;</span><br><span class="line">    &#125;),</span><br><span class="line">    (n.n = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> t =</span><br><span class="line">        e &amp;&amp; e.__esModule</span><br><span class="line">          ? <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">              <span class="keyword">return</span> e.default;</span><br><span class="line">            &#125;</span><br><span class="line">          : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">              <span class="keyword">return</span> e;</span><br><span class="line">            &#125;;</span><br><span class="line">      <span class="keyword">return</span> n.d(t, <span class="string">"a"</span>, t), t;</span><br><span class="line">    &#125;),</span><br><span class="line">    (n.o = <span class="function"><span class="keyword">function</span>(<span class="params">e, t</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, t);</span><br><span class="line">    &#125;),</span><br><span class="line">    (n.p = <span class="string">""</span>),</span><br><span class="line">    n((n.s = <span class="number">0</span>));</span><br><span class="line">&#125;)([</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">e, t, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> r = n(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(r);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">e, t</span>) </span>&#123;</span><br><span class="line">    e.exports = <span class="string">"longtean"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p>可以看到，由于使用了commonJS的模块化语法，而这个模块化语法无法运行在浏览器端，webpack在打包输出的文件里帮我们进行了处理，使得代码可以运行在浏览器端。</p>
<h2 id="手动配置"><a href="#手动配置" class="headerlink" title="手动配置"></a>手动配置</h2><p>根目录新建配置文件 <code>webpack.config.js</code></p>
<p>默认的配置文件名写法有两种，第二种是<code>webpackfile.js</code>,在运行webpack命令后，会执行node_modules下的<code>webpack-cli/bin/config-yargs.js</code>,defaultDescription属性中规定了默认配置文件名称</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode:<span class="string">'development'</span>, <span class="comment">//模式    默认 production 和 development</span></span><br><span class="line">  entry:<span class="string">'./src/index.js'</span>, <span class="comment">//入口文件</span></span><br><span class="line">  output:&#123;</span><br><span class="line">     filename:<span class="string">'bundle.[hash:8].js'</span>, <span class="comment">//打包后的文件名</span></span><br><span class="line">    path: path.resolve(__dirname,<span class="string">'dist'</span>), <span class="comment">//路径必须是绝对路径 resolve()方法可以将相对路径解析为绝对路径</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>development模式打包出的bundle.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123; <span class="comment">// webpackBootstrap</span></span><br><span class="line"> 	<span class="comment">// 模块缓存</span></span><br><span class="line"> 	<span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// 实现 require 方法  __webpack_require__</span></span><br><span class="line"> 	<span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"> 		<span class="comment">// Check if module is in cache</span></span><br><span class="line"> 		<span class="keyword">if</span>(installedModules[moduleId]) &#123;</span><br><span class="line"> 			<span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line"> 		&#125;</span><br><span class="line"> 		<span class="comment">// Create a new module (and put it into the cache)</span></span><br><span class="line"> 		<span class="keyword">var</span> <span class="built_in">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line"> 			i: moduleId,</span><br><span class="line"> 			l: <span class="literal">false</span>,</span><br><span class="line"> 			exports: &#123;&#125;</span><br><span class="line"> 		&#125;;</span><br><span class="line"></span><br><span class="line"> 		<span class="comment">// Execute the module function</span></span><br><span class="line"> 		modules[moduleId].call(<span class="built_in">module</span>.exports, <span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line"> 		<span class="comment">// Flag the module as loaded</span></span><br><span class="line"> 		<span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"> 		<span class="comment">// Return the exports of the module</span></span><br><span class="line"> 		<span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line"> 	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// expose the modules object (__webpack_modules__)</span></span><br><span class="line"> 	__webpack_require__.m = modules;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// expose the module cache</span></span><br><span class="line"> 	__webpack_require__.c = installedModules;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// define getter function for harmony exports</span></span><br><span class="line"> 	__webpack_require__.d = <span class="function"><span class="keyword">function</span>(<span class="params">exports, name, getter</span>) </span>&#123;</span><br><span class="line"> 		<span class="keyword">if</span>(!__webpack_require__.o(exports, name)) &#123;</span><br><span class="line"> 			<span class="built_in">Object</span>.defineProperty(exports, name, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: getter &#125;);</span><br><span class="line"> 		&#125;</span><br><span class="line"> 	&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// define __esModule on exports</span></span><br><span class="line"> 	__webpack_require__.r = <span class="function"><span class="keyword">function</span>(<span class="params">exports</span>) </span>&#123;</span><br><span class="line"> 		<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line"> 			<span class="built_in">Object</span>.defineProperty(exports, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">'Module'</span> &#125;);</span><br><span class="line"> 		&#125;</span><br><span class="line"> 		<span class="built_in">Object</span>.defineProperty(exports, <span class="string">'__esModule'</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"> 	&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// create a fake namespace object</span></span><br><span class="line"> 	<span class="comment">// mode &amp; 1: value is a module id, require it</span></span><br><span class="line"> 	<span class="comment">// mode &amp; 2: merge all properties of value into the ns</span></span><br><span class="line"> 	<span class="comment">// mode &amp; 4: return value when already ns object</span></span><br><span class="line"> 	<span class="comment">// mode &amp; 8|1: behave like require</span></span><br><span class="line"> 	__webpack_require__.t = <span class="function"><span class="keyword">function</span>(<span class="params">value, mode</span>) </span>&#123;</span><br><span class="line"> 		<span class="keyword">if</span>(mode &amp; <span class="number">1</span>) value = __webpack_require__(value);</span><br><span class="line"> 		<span class="keyword">if</span>(mode &amp; <span class="number">8</span>) <span class="keyword">return</span> value;</span><br><span class="line"> 		<span class="keyword">if</span>((mode &amp; <span class="number">4</span>) &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'object'</span> &amp;&amp; value &amp;&amp; value.__esModule) <span class="keyword">return</span> value;</span><br><span class="line"> 		<span class="keyword">var</span> ns = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line"> 		__webpack_require__.r(ns);</span><br><span class="line"> 		<span class="built_in">Object</span>.defineProperty(ns, <span class="string">'default'</span>, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">value</span>: value &#125;);</span><br><span class="line"> 		<span class="keyword">if</span>(mode &amp; <span class="number">2</span> &amp;&amp; <span class="keyword">typeof</span> value != <span class="string">'string'</span>) <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> value) __webpack_require__.d(ns, key, <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123; <span class="keyword">return</span> value[key]; &#125;.bind(<span class="literal">null</span>, key));</span><br><span class="line"> 		<span class="keyword">return</span> ns;</span><br><span class="line"> 	&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// getDefaultExport function for compatibility with non-harmony modules</span></span><br><span class="line"> 	__webpack_require__.n = <span class="function"><span class="keyword">function</span>(<span class="params">module</span>) </span>&#123;</span><br><span class="line"> 		<span class="keyword">var</span> getter = <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.__esModule ?</span><br><span class="line"> 			<span class="function"><span class="keyword">function</span> <span class="title">getDefault</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>[<span class="string">'default'</span>]; &#125; :</span><br><span class="line"> 			<span class="function"><span class="keyword">function</span> <span class="title">getModuleExports</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>; &#125;;</span><br><span class="line"> 		__webpack_require__.d(getter, <span class="string">'a'</span>, getter);</span><br><span class="line"> 		<span class="keyword">return</span> getter;</span><br><span class="line"> 	&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// Object.prototype.hasOwnProperty.call</span></span><br><span class="line"> 	__webpack_require__.o = <span class="function"><span class="keyword">function</span>(<span class="params">object, property</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(object, property); &#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="comment">// __webpack_public_path__</span></span><br><span class="line"> 	__webpack_require__.p = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 加载入口模块 返回导出的对象</span></span><br><span class="line"> 	<span class="keyword">return</span> __webpack_require__(__webpack_require__.s = <span class="string">"./src/index.js"</span>);</span><br><span class="line"> &#125;)</span><br><span class="line"><span class="comment">/************************************************************************/</span></span><br><span class="line"> (&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***/</span> <span class="string">"./src/index.js"</span>:</span><br><span class="line"><span class="comment">/*!**********************!*\</span></span><br><span class="line"><span class="comment">  !*** ./src/index.js ***!</span></span><br><span class="line"><span class="comment">  \**********************/</span></span><br><span class="line"><span class="comment">/*! no static exports found */</span></span><br><span class="line"><span class="comment">/***/</span> (<span class="function"><span class="keyword">function</span>(<span class="params">module, exports, __webpack_require__</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"const str = __webpack_require__(/*! ./test.js */ \"./src/test.js\")\nconsole.log(str)\n\n//# sourceURL=webpack:///./src/index.js?"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/***/</span> &#125;),</span><br><span class="line"></span><br><span class="line"><span class="comment">/***/</span> <span class="string">"./src/test.js"</span>:</span><br><span class="line"><span class="comment">/*!*********************!*\</span></span><br><span class="line"><span class="comment">  !*** ./src/test.js ***!</span></span><br><span class="line"><span class="comment">  \*********************/</span></span><br><span class="line"><span class="comment">/*! no static exports found */</span></span><br><span class="line"><span class="comment">/***/</span> (<span class="function"><span class="keyword">function</span>(<span class="params">module, exports</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"module.exports = 'longtean test'\n\n//# sourceURL=webpack:///./src/test.js?"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/***/</span> &#125;)</span><br><span class="line"></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>
<p><strong>也可以指定配置文件名称</strong></p>
<p>运行 webpack –config webpack.config.<code>selfname</code>.js  就可以以指定配置文件进行打包</p>
<p>或者package.json 文件中添加script脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"webpack --config webpack.config.js"</span>  <span class="comment">//在这里进行配置</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h2><p>安装本地开发服务器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack-dev-server -D</span><br></pre></td></tr></table></figure>
<p>添加执行脚本<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server"</span> </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>配置本地服务<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.cpnfig.js</span></span><br><span class="line"></span><br><span class="line"> devServer:&#123; <span class="comment">//开发服务器配置</span></span><br><span class="line">    port:<span class="number">3001</span>,</span><br><span class="line">    progress:<span class="literal">true</span>, <span class="comment">//是否显示进度条</span></span><br><span class="line">    contentBase: <span class="string">'./dist'</span>, <span class="comment">//以指定目录运行静态服务</span></span><br><span class="line">    open:<span class="literal">true</span>, <span class="comment">//自动打开浏览器</span></span><br><span class="line">    compress:<span class="literal">true</span>  <span class="comment">//压缩</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>npm run dev 即可自动打开浏览器并访问3001端口</p>
<h2 id="Html处理"><a href="#Html处理" class="headerlink" title="Html处理"></a>Html处理</h2><p>src目录下创建index.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>需要安装 <code>html-webpack-plugin</code>插件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i html-webpack-plugin -D</span><br></pre></td></tr></table></figure>
<p>在配置文件中引入<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  plugins:[ <span class="comment">//数组，放置左右webpack插件</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template:<span class="string">'./src/index.html'</span>, <span class="comment">//模板文件路径</span></span><br><span class="line">      filename:<span class="string">'index.html'</span>,  <span class="comment">//输出文件名</span></span><br><span class="line">      minify:&#123;</span><br><span class="line">        removeAttributeQuotes:<span class="literal">true</span>, <span class="comment">//删除双引号</span></span><br><span class="line">        collapseWhitespace:<span class="literal">true</span> <span class="comment">//折叠空行</span></span><br><span class="line">      &#125;,</span><br><span class="line">      hash:<span class="literal">true</span> <span class="comment">//加hash</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="css处理"><a href="#css处理" class="headerlink" title="css处理"></a>css处理</h2><p>src下创建index.css index.scss文件</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js中引入样式文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./index.css'</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./index.scss'</span>)</span><br></pre></td></tr></table></figure></p>
<p>webpack并不能识别css代码，这时候需要安装loader来解析</p>
<p>安装 <code>css-loader</code> <code>style-loader</code> <code>sass-loader</code> <code>node-sass</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i css-loader style-loader sass-loader node-sass -D</span><br></pre></td></tr></table></figure></p>
<p>在配置文件中添加module配置<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="built_in">module</span>:&#123;<span class="comment">//模块</span></span><br><span class="line">    rules:[ </span><br><span class="line">      <span class="comment">//规则 css-loader 解析 @import </span></span><br><span class="line">      <span class="comment">//style-loader css插入head标签</span></span><br><span class="line">      <span class="comment">//使用单个时loader名为字符串，多个loader时数组，需要配置参数options时对象</span></span><br><span class="line">      <span class="comment">//loader执行顺序为自右向左 自下而上</span></span><br><span class="line">     &#123;</span><br><span class="line">        test:<span class="regexp">/\.css$/</span>,</span><br><span class="line">        use:[</span><br><span class="line">          &#123;</span><br><span class="line">            loader:<span class="string">'style-loader'</span>,</span><br><span class="line">            options:&#123;</span><br><span class="line">              insertAt:<span class="string">'top'</span>  <span class="comment">//style标签插入到顶部</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">'css-loader'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test:<span class="regexp">/\.scss$/</span>,</span><br><span class="line">        use:[</span><br><span class="line">          &#123;</span><br><span class="line">            loader:<span class="string">'style-loader'</span>,</span><br><span class="line">            options:&#123;</span><br><span class="line">              insertAt:<span class="string">'top'</span>  <span class="comment">//style标签插入到顶部</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          <span class="string">'sass-loader'</span> <span class="comment">// sass-loader 依赖node-sass  所以也得安装</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>npm run build 之后就会发现，css样式以style标签的形式，被插入在了<code>head</code>标签的顶部</p>
<p>如果想将css分离成独立的css文件，以link的形式引入，则需要用到<code>mini-extract-plugin</code>这个插件</p>
<p>修改配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">  plugins:[ </span><br><span class="line">   ...</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename:<span class="string">'main.css'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="built_in">module</span>:&#123;</span><br><span class="line">    rules:[ </span><br><span class="line">      &#123;</span><br><span class="line">        test:<span class="regexp">/\.css$/</span>,</span><br><span class="line">        use:[</span><br><span class="line">            <span class="comment">//用MiniCssExtractPlugin.loader 代替 style-loader</span></span><br><span class="line">            MiniCssExtractPlugin.loader,</span><br><span class="line">           <span class="string">'css-loader'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test:<span class="regexp">/\.scss$/</span>,</span><br><span class="line">        use:[</span><br><span class="line">          MiniCssExtractPlugin.loader,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          <span class="string">'sass-loader'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>build之后就会发现，打包出来的main.css以link形式被引入到了html文件中。</p>
<p>如果想给css自动添加前缀，则需要安装<code>postcss-loader</code>和<code>autoprefixer</code>这两个插件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:<span class="regexp">/\.scss$/</span>,</span><br><span class="line">    use:[</span><br><span class="line">      MiniCssExtractPlugin.loader,</span><br><span class="line">      <span class="string">'css-loader'</span>,</span><br><span class="line">      <span class="string">'postcss-loader'</span>,</span><br><span class="line">      <span class="string">'sass-loader'</span> <span class="comment">// sass-loader 依赖node-sass  所以也得安装</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需要给postcss添加一个配置文件才能使用postcss,根目录添加<code>postcss.config.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins:[<span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之前的js文件都是压缩的，想要css也压缩的话，需要使用插件<code>optimize-css-assets-webpack-plugin</code></p>
<p>修改配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> OptimizeCss = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  optimization:&#123; <span class="comment">//优化项</span></span><br><span class="line">    minimizer:[</span><br><span class="line">      <span class="keyword">new</span> OptimizeCss()</span><br><span class="line">   ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行后发现，css被压缩，但是js却没有压缩，这是因为optimization.minimizer属性后js就默认不被压缩了，使用<code>gulifyjs-webpack-plugin</code>插件可以压缩js</p>
<p>安装之后修改配置文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> OptimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  optimization:&#123; <span class="comment">//优化项</span></span><br><span class="line">    minimizer:[</span><br><span class="line">      <span class="keyword">new</span> OptimizeCssAssetsPlugin(),</span><br><span class="line">      <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">        cache:<span class="literal">true</span>,</span><br><span class="line">        parallel:<span class="literal">true</span> <span class="comment">//支持同时压缩多个</span></span><br><span class="line">      &#125;)</span><br><span class="line">   ]</span><br><span class="line">  &#125;,</span><br><span class="line">  mode:<span class="string">'production'</span>, <span class="comment">//模式    默认 production 和 development</span></span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再次npm run build之后，文件都被压缩了</p>
<h2 id="处理js"><a href="#处理js" class="headerlink" title="处理js"></a>处理js</h2><h3 id="1-处理es6"><a href="#1-处理es6" class="headerlink" title="1. 处理es6+"></a>1. <strong>处理es6+</strong></h3><p>在index.js中写一些es6的语法，在build之后发现打包出来的js仍旧使用ES6写法，为了兼容性，我们需要转化成ES5的写法，这时候需要安装<code>babel</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i babel-loader @babel/core @babel/preset-env -D</span><br></pre></td></tr></table></figure>
<p>修改配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"> ...</span><br><span class="line">  <span class="built_in">module</span>:&#123;<span class="comment">//模块</span></span><br><span class="line">    rules:[&#123;</span><br><span class="line">        test:<span class="regexp">/\.js$/</span>,</span><br><span class="line">        use:&#123;</span><br><span class="line">          loader:<span class="string">'babel-loader'</span>, </span><br><span class="line">          options:&#123;</span><br><span class="line">            presets:[</span><br><span class="line">              <span class="string">'@babel/preset-env'</span></span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>之后npm run build之后就可以将es6代码转化成es5代码了</p>
<p>接下来往index.js增加<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    a=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> A()</span><br><span class="line"><span class="built_in">console</span>.log(a.a)</span><br></pre></td></tr></table></figure></p>
<p><code>npm run build</code>之后发现提示需要安装<code>@babel/plugin-proposal-class-properties</code>插件，这是因为class属性目前处于提案中，所以babel通过单独插件的方式来支持编译。</p>
<p>安装这个插件之后修改配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"> ...</span><br><span class="line">  <span class="built_in">module</span>:&#123;<span class="comment">//模块</span></span><br><span class="line">    rules:[&#123;</span><br><span class="line">        test:<span class="regexp">/\.js$/</span>,</span><br><span class="line">        use:&#123;</span><br><span class="line">          loader:<span class="string">'babel-loader'</span>, </span><br><span class="line">          options:&#123;</span><br><span class="line">            presets:[</span><br><span class="line">              <span class="string">'@babel/preset-env'</span></span><br><span class="line">            ]，</span><br><span class="line">            </span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果我们要使用装饰器模式的话，需要安装插件<code>@babel/plugin-proposal-decorators</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@log</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> A()</span><br><span class="line"><span class="built_in">console</span>.log(a.a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(target)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改配置文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"> ...</span><br><span class="line">  <span class="built_in">module</span>:&#123;<span class="comment">//模块</span></span><br><span class="line">    rules:[&#123;</span><br><span class="line">        test:<span class="regexp">/\.js$/</span>,</span><br><span class="line">        use:&#123;</span><br><span class="line">          loader:<span class="string">'babel-loader'</span>, </span><br><span class="line">          options:&#123;</span><br><span class="line">            presets:[</span><br><span class="line">              <span class="string">'@babel/preset-env'</span></span><br><span class="line">            ]，</span><br><span class="line">            plugins:[</span><br><span class="line">              <span class="comment">//注意安装顺序</span></span><br><span class="line">              [<span class="string">"@babel/plugin-proposal-decorators"</span>, &#123; <span class="string">"legacy"</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">              <span class="string">'@babel/plugin-proposal-class-properties'</span></span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在test.js 写另外一个Class B，同时也写一些处理异步流程的Generator语法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> * <span class="title">gen</span>(<span class="params">params</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">console</span>.log(gen().next())</span><br></pre></td></tr></table></figure></p>
<p>打包之后，发现虽然将ES6转化为了ES5的语法，但是gemerator这中内置api并没有转化，所以需要安装插件<code>@babel/plugin-transform-runtime</code>,以及在生产环境下注入一些脚本依赖的插件<code>@babel/runtime</code>，通过创建了一个helper方法将需要用到的公共方法抽离出来，避免了多个模块定义重复定义方法。</p>
<p>如果代码中存在一些实例上的方法，比如说数组的includes(),在编译的过程中是不会进行转化的，需要安装<code>@babel/polyfill</code>,因为需要在代码运行时使用，所以不能<code>--save-dev</code>来安装，插件会在Array的原型上重新实现个includes方法。</p>
<p>安装之后，修改配置文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"@babel/polyfill"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: [<span class="string">"@babel/polyfill"</span>, <span class="string">"./src/index.js"</span>] </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过在入口文件添加polyfill插件，为打包之后的代码插入在原有的JS内置对象及方法上做向后兼容的处理的代码。比如说ES5里面的 Object 是没有自带 assign 方法的，那么你加载了babel-polyfill 之后，它就给 Object 扩展了一个 assign 方法，这样你就可以直接使用 Object.assign(obj1, obj2) 了</p>
<h3 id="2-增加eslint"><a href="#2-增加eslint" class="headerlink" title="2. 增加eslint"></a>2. <strong>增加eslint</strong></h3><p>添加eslint可以对我们的代码添加一些语法规范的校验</p>
<p>安装 <code>npm i eslint eslint-loader -D</code></p>
<p>在配置文件中添加loader<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">        &#123;</span><br><span class="line">            test:<span class="regexp">/\.js$/</span>,</span><br><span class="line">            use:&#123;</span><br><span class="line">                loader:<span class="string">'eslint-loader'</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    enforce:pre <span class="comment">//强制在最前面执行，最先执行的loader</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">       ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以在eslint官网根据自己的需求勾选不同的规则，最终生成<code>.eslintrc.json</code>文件放置在项目的根目录中。</p>
<h2 id="全局变量引入"><a href="#全局变量引入" class="headerlink" title="全局变量引入"></a>全局变量引入</h2><h3 id="暴露到全局对象上"><a href="#暴露到全局对象上" class="headerlink" title="暴露到全局对象上"></a>暴露到全局对象上</h3><p>想要全局引用某个变量，需要用到<code>expose-loader</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm  i expose-loader -D</span><br></pre></td></tr></table></figure>
<p>在index.js中引入 jquery的 <code>$</code> 并暴露给window对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &apos;expose-loader?$!jquery&apos;</span><br><span class="line"></span><br><span class="line">console.log(window.$)</span><br></pre></td></tr></table></figure>
<p>npm run dev 之后控制台可以打印出$对象</p>
<p>也可以再webpack配置文件中添加</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    rules:[</span><br><span class="line">        &#123;</span><br><span class="line">            test:<span class="built_in">require</span>.resolve(<span class="string">'jquery'</span>), <span class="comment">//匹配模块中对jq的引用</span></span><br><span class="line">            use:<span class="string">'expose-loader?$'</span>  <span class="comment">//暴露给全局的window.$</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种方式需要在使用的文件中手动的import jquery,还有另外一种方式，可以将$注入到每个模块中这样我们就可以任意的使用$而不需要手动引入了</p>
<h3 id="注入到每个模块"><a href="#注入到每个模块" class="headerlink" title="注入到每个模块"></a>注入到每个模块</h3><p>需要使用到webpack的插件 在配置文件的plugin中添加<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.ProvidePlugin(&#123; <span class="comment">//在每个模块中都注入$</span></span><br><span class="line">      $:<span class="string">'jquery'</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h3 id="引入不打包"><a href="#引入不打包" class="headerlink" title="引入不打包"></a>引入不打包</h3><p>如果我们通过import等引入了jq,但不希望webpack把这个库打包进bundle,js  就可以使用<code>externals</code>,在配置文件中添加</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    externals:&#123;</span><br><span class="line">        jquery:<span class="string">'$'</span> <span class="comment">//引入$ 不打包</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种方式就需要依赖运行环境包含<code>$</code></p>
<blockquote>
<p>总结 <br><br>1.expose-loader 暴露到window上  <br><br>2.webpack.ProvideOlugin 注入到每个模块 <br><br>3.引入不打包 <br></p>
</blockquote>
<h2 id="图片处理"><a href="#图片处理" class="headerlink" title="图片处理"></a>图片处理</h2><p>在js中通过import或者require来引入图片，是一个字符串，并不能被webpack识别，需要使用<code>file-loader</code>来处理图片的路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i file-loader -D</span><br></pre></td></tr></table></figure>
<p>在配置文件中添加<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    rules:[</span><br><span class="line">        &#123;</span><br><span class="line">            test:<span class="regexp">/.\(jpg,png,gif)$/</span>,</span><br><span class="line">            <span class="comment">//css中引入的图片会被css-loader处理成require方式引入</span></span><br><span class="line">            use:<span class="string">'file-loader'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果想要在HTML文件中引入图片，需要使用loader <code>html-withimg-loader</code>,解析出html中的图片引入</p>
<p>安装之后配置rules<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    rules:[</span><br><span class="line">        &#123;</span><br><span class="line">            test:<span class="regexp">/\.html$/</span>,</span><br><span class="line">            use:<span class="string">'html-withimg-loader'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>开发中图片很多，一些比较小的图片可以转化成base64格式，从而减少http请求，需要用到<code>url-loader</code></p>
<p>安装之后修改配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    rules:[</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">			<span class="comment">// 当图片小于200k时转化为base64格式</span></span><br><span class="line">			<span class="comment">// 大于则使用url-loader内置的file-loader处理</span></span><br><span class="line">			use: &#123;</span><br><span class="line">				loader: <span class="string">'url-loader'</span>,</span><br><span class="line">				options: &#123;</span><br><span class="line">					limit: <span class="number">200</span>*<span class="number">1024</span>,</span><br><span class="line">					outputPath:<span class="string">'/img/'</span>, </span><br><span class="line">					PubilcPath:<span class="string">'https://daojia.jd.com'</span> </span><br><span class="line">					</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="打包多页应用"><a href="#打包多页应用" class="headerlink" title="打包多页应用"></a>打包多页应用</h2><p>之前的配置都是针对单页面应用，接下来配置多页面应用。</p>
<p>src下新建index.js 和 other.js两个文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> HTMLWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="string">'development'</span>,</span><br><span class="line">    <span class="comment">//多入口</span></span><br><span class="line">    entry:&#123;</span><br><span class="line">        home:<span class="string">'./src/index.js'</span>,</span><br><span class="line">        pther:<span class="string">'./src/other.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename:<span class="string">'[name].[hash]js'</span>,</span><br><span class="line">        path:path.resolve(__dirname,<span class="string">'dist'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//需要配置多个 HTMLWebpackPlugin  chunks 表示页面的入口文件</span></span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="keyword">new</span> HTMLWebpackPlugin(&#123;</span><br><span class="line">            template:<span class="string">'./src/index.html'</span>,</span><br><span class="line">            filename:<span class="string">'home.html'</span>,</span><br><span class="line">            chunks:[<span class="string">'home'</span>]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> HTMLWebpackPlugin(&#123;</span><br><span class="line">            template:<span class="string">'./src/other.html'</span>,</span><br><span class="line">            filename:<span class="string">'other.html'</span>,</span><br><span class="line">            chunks:[<span class="string">'other'</span>,<span class="string">'home'</span>] <span class="comment">//写多个，会引用多个js</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="source-map"><a href="#source-map" class="headerlink" title="source-map"></a>source-map</h2><p>打包之后，代码压缩成一行，如果代码有错误，我们很难在压缩后的代码中定位到错误，这个时候就需要通过webpack的devtool配置来进行源码的映射。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    devtool:<span class="string">'source-map'</span>, <span class="comment">//增加映射文件，方便调试源码，会生成一个sourcemap文件，显示错误的行和列</span></span><br><span class="line">    <span class="comment">//devtool:'eval-source-map'  不会产生单独source-map 文件，集成在代码中</span></span><br><span class="line">    <span class="comment">//devtool:'cheap-module-source-map' 产生单独的source-map 不会提示错误在第几行</span></span><br><span class="line">    <span class="comment">//devtool:'cheap-module-eval-source-map'  不会产生文件，不提示列，只提示行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="watch-实时打包"><a href="#watch-实时打包" class="headerlink" title="watch 实时打包"></a>watch 实时打包</h2><p>通过打开watch属性是实现时时打包,这样就可以真机调试了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    watch:<span class="literal">true</span>,</span><br><span class="line">    watchOptions:&#123;</span><br><span class="line">        poll:<span class="number">1000</span>,  监控的间隔时间,一秒检查一次是否需要打包</span><br><span class="line">        aggregateTimeout:<span class="number">500</span> <span class="comment">// 防抖，输入500毫秒后无输入再打包</span></span><br><span class="line">        ignore:<span class="regexp">/node_modules/</span> <span class="comment">//不需要监控的文件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样每次都改之后都会自动重新打包</p>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><ul>
<li><p>CleanWebpackPlugin</p>
<p>作用是打包之前清空dist目录</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    plugins:[</span><br><span class="line">       <span class="keyword">new</span> CleanWebpackPlugin(<span class="string">'./dist'</span>)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>CopyWebpackPlugin</p>
<p>作用是打包时复制文件到打包的目录</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    plugins:[</span><br><span class="line">       <span class="keyword">new</span> CleanWebpackPlugin([</span><br><span class="line">       &#123; <span class="attr">from</span>:<span class="string">'./public'</span>,<span class="attr">to</span>:<span class="string">'./'</span>&#125; <span class="comment">//从哪拷贝到哪</span></span><br><span class="line">       ])</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>BannerPlugin (内置)</li>
</ul>
<p>作用是给打包后的js和css文件头部添加注释</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.BannerPlugin(<span class="string">'我是需要添加的注释'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="跨域问题"><a href="#跨域问题" class="headerlink" title="跨域问题"></a>跨域问题</h2><p>开发过程中都是localhost本地服务，就会遇到接口请求的跨域问题。</p>
<p>一、可以通过webpack配置devServer.proxy设置代理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">proxy:&#123;</span><br><span class="line">    <span class="string">'api/'</span>:&#123;</span><br><span class="line">        target:<span class="string">'baidu.com'</span>, <span class="comment">//需要代理到的url</span></span><br><span class="line">        pathRewrite:&#123;</span><br><span class="line">            <span class="string">'/api'</span>:<span class="string">''</span>  <span class="comment">//将/api重写</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>二、如果前端需要mock数据,可以利用webpack内置的express 服务器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">devServer:&#123;</span><br><span class="line">    before(app)&#123;</span><br><span class="line">        app.get(<span class="string">'/api'</span>,(req,res)=&gt;&#123;</span><br><span class="line">            res.json(&#123;</span><br><span class="line">                xxx:xxx</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h2><p>resolve可以解析第三方的包</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    rules:[],</span><br><span class="line">    resolve:&#123;</span><br><span class="line">        modules:[path.resolve(<span class="string">'node_modules'</span>)], <span class="comment">//指定优先查找当前目录的node_modules</span></span><br><span class="line">        alias:&#123;</span><br><span class="line">            <span class="comment">//配置别名</span></span><br><span class="line">            <span class="string">'bootstrap'</span>:<span class="string">'./dist/js/...'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        extensions:[<span class="string">'js'</span>,<span class="string">'css'</span>,<span class="string">'jsx'</span>,<span class="string">'vue'</span>], <span class="comment">//按照这个顺序查找后缀的文件</span></span><br><span class="line">        mainFields:[<span class="string">'main'</span>,<span class="string">'style'</span>,<span class="string">'css'</span>], <span class="comment">//引用的文件的主入口字段，对应packages.json</span></span><br><span class="line">        mainFiles:[<span class="string">'main'</span>],  <span class="comment">//主入口文件的名字 默认是index</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="定义环境变量"><a href="#定义环境变量" class="headerlink" title="定义环境变量"></a>定义环境变量</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">			DEV: <span class="string">"'dev'"</span>, <span class="comment">// JSON.stringify('dev')</span></span><br><span class="line">			TAG:<span class="string">'true'</span> <span class="comment">//boolean 类型</span></span><br><span class="line">		&#125;)</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="区分不同环境"><a href="#区分不同环境" class="headerlink" title="区分不同环境"></a>区分不同环境</h2><p>可以将不同环境的配置文件分开写</p>
<ul>
<li>webpack.dev.js</li>
<li>webpack.base.js</li>
<li>webpack.prod.js</li>
</ul>
<p>base写基础的配置，通过插件 webpack-merge 来合并到dev 和 prod 文件中</p>
<p>webpack.dev.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; smart &#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">let</span> base = <span class="built_in">require</span>(<span class="string">'./webpack.base.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smart(base,&#123;</span><br><span class="line">    mode:<span class="string">'development'</span>,</span><br><span class="line">    <span class="comment">// 其他配置</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>webpack.prod.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; smart &#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">let</span> base = <span class="built_in">require</span>(<span class="string">'./webpack.base.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smart(base,&#123;</span><br><span class="line">    mode:<span class="string">'production'</span>,</span><br><span class="line">    <span class="comment">// 其他配置</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>修改project.json 中 脚本执行命令<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>:&#123;</span><br><span class="line">        <span class="string">"dev"</span>:<span class="string">"webpack --config webpack.dev.js"</span>,</span><br><span class="line">        <span class="string">"build"</span>:<span class="string">"webpack --config webpack.prod.js"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>webpack优化</p>
</blockquote>
<h2 id="noParse"><a href="#noParse" class="headerlink" title="noParse"></a>noParse</h2><p>wekpack的module有一个 noParse 属性，可以设置不解析引入库的依赖</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>:&#123;</span><br><span class="line">    noParse:<span class="regexp">/jquery/</span>  <span class="comment">//不解析jquery的依赖 </span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ignorePlugin"><a href="#ignorePlugin" class="headerlink" title="ignorePlugin"></a>ignorePlugin</h2><p>这是webpack的内置插件，当项目中引入了库的时候，这些库还会引入其他一些库，可以通过这个插件将这些引入的库忽略，减小打包的体积。</p>
<p>例如引用monment这个库时，会引入很多语言包文件，这些对于我们来说并不需要，这些包都存放在./locale目录下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="comment">//忽略 moment 引入的库</span></span><br><span class="line">        <span class="keyword">new</span> webpack.IgnorePlugin(<span class="regexp">/./</span>locale/,/moment/)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="dllPlugin"><a href="#dllPlugin" class="headerlink" title="dllPlugin"></a>dllPlugin</h2><p>通过提供分离包的方式来提升构建时间性能，使打包更快。其主要思想就是 将一些不做修改的依赖文件，提前打包，这样再发布前打包代码的时候就不需要对这部分代码进行打包。</p>
<p>在原来打包文件的基础上，新建一个webpack.dll.conf.js，webpack.dll.config.js作用是把所有的第三方库依赖打包到一个bundle的dll文件里面，还会生成一个名为 manifest.json文件，manifest.json的作用是用来让 DllReferencePlugin 映射到相关的依赖上去的</p>
<p><em>DllReferencePlugin</em></p>
<p>这个插件是在webpack.config.js中使用的，该插件的作用是把刚刚在webpack.dll.config.js中打包生成的dll文件引用到需要的预编译的依赖上来.就是说在webpack.dll.config.js中打包后比如会生成 vendor.dll.js文件和vendor-manifest.json文件，vendor.dll.js文件包含所有的第三方库文件，vendor-manifest.json文件会包含所有库代码的一个索引，当在使用webpack.config.js文件打包DllReferencePlugin插件的时候，会使用该DllReferencePlugin插件读取vendor-manifest.json文件，看看是否有该第三方库。vendor-manifest.json文件就是有一个第三方库的一个映射</p>
<p>只需要对这些第三方库打包一次，以后每次打包webpack.conf.js的时候，只需要打包项目的代码，当使用到第三方依赖的时候，会使用DllReferencePlugin 读取已经提前打包好的第三方库，从而提高打包速度，当第三方库有更新的时候，咋需要从新打包webpack.dll.conf.js </p>
<p>webpack.dll.conf.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry:&#123;</span><br><span class="line">        vender:[</span><br><span class="line">            <span class="string">'react'</span>,</span><br><span class="line">            <span class="string">'react-dom'</span>,</span><br><span class="line">            <span class="string">'babel-polyfill'</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename:<span class="string">'[name].dll.js'</span>,</span><br><span class="line">        path:path.resolve(__dirname,<span class="string">'dist'</span>),</span><br><span class="line">        library:<span class="string">'[name]_library'</span> <span class="comment">//可选，暴露出的全局变量名字</span></span><br><span class="line">        <span class="comment">// 主要是给DllPlugin中的name使用，</span></span><br><span class="line">        <span class="comment">// 所以这里需要和webpack.DllPlugin中的`name: '[name]_library',`保持一致</span></span><br><span class="line">        </span><br><span class="line">    &#125;,</span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">            path: path.join(__dirname, <span class="string">'dist'</span>, <span class="string">'[name]-manifest.json'</span>), <span class="comment">//生成上文说到清单文件，放在dist文件下面</span></span><br><span class="line">            name: <span class="string">'[name]_library'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>webpack.conf.js</p>
<p>先安装add-asset-html-webpack-plugin这个插件，目的是给生成的vender.dll.js加上hash值,然后插入到htmk中去 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> AddAssetHtmlPlugin = <span class="built_in">require</span>(<span class="string">'add-asset-html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins:[</span><br><span class="line">          <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">                context: path.resolve(__dirname, <span class="string">'..'</span>),  <span class="comment">//manifest文件中请求的上下文</span></span><br><span class="line">                manifest: <span class="built_in">require</span>(<span class="string">'./dist/vendor-manifest.json'</span>)</span><br><span class="line">            &#125;),</span><br><span class="line">    <span class="comment">//这个主要是将生成的vendor.dll.js文件加上hash值插入到页面中。</span></span><br><span class="line">    <span class="keyword">new</span> AddAssetHtmlPlugin([&#123;</span><br><span class="line">      filepath: path.resolve(__dirname,<span class="string">'../dist/js/vendor.dll.js'</span>),\</span><br><span class="line">      includeSourcemap: <span class="literal">false</span>,</span><br><span class="line">      hash: <span class="literal">true</span></span><br><span class="line">    &#125;]),</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后，在package.json中配置运行命令<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>:&#123;</span><br><span class="line">        <span class="string">"build:dll"</span>: <span class="string">"webpack --config webpack.dll.conf.js"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="happypack"><a href="#happypack" class="headerlink" title="happypack"></a>happypack</h2><p>happypack 可以开启多线程打包，这对于比较大的项目，可以提高打包速度。</p>
<p><code>npm i happypack -D</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> happypack = <span class="built_in">require</span>(<span class="string">'happypack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="keyword">new</span> happypack(&#123;</span><br><span class="line">            id:<span class="string">'js'</span>,</span><br><span class="line">            use:[&#123;</span><br><span class="line">                loader:<span class="string">'babel-loader'</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    preset:[<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> happypack(&#123;</span><br><span class="line">            id:<span class="string">'css'</span>,</span><br><span class="line">            use:[</span><br><span class="line">                MiniCssExtractPlugin.loader,</span><br><span class="line">				<span class="string">'css-loader'</span>,</span><br><span class="line">				<span class="string">'postcss-loader'</span></span><br><span class="line">			]</span><br><span class="line">        &#125;)，</span><br><span class="line">    ],</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        rules: [</span><br><span class="line">		&#123;</span><br><span class="line">			test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">			<span class="comment">//js用happypack/loader多线程打包</span></span><br><span class="line">			use: <span class="string">'happypack/loader?id=js'</span>,</span><br><span class="line">			include: path.resolve(__dirname, <span class="string">'src'</span>),</span><br><span class="line">			exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">		&#125;, &#123;</span><br><span class="line">			test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">			<span class="comment">//css用happypack/loader多线程打包</span></span><br><span class="line">			use: <span class="string">'happypack/loader?id=css'</span>,</span><br><span class="line">			include: path.resolve(__dirname, <span class="string">'src'</span>),</span><br><span class="line">			exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">		&#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于分配多线程也需要占用时间，因此在比较小的项目上效果不明显。</p>
<h2 id="webpack自带优化"><a href="#webpack自带优化" class="headerlink" title="webpack自带优化"></a>webpack自带优化</h2><h3 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree-shaking"></a>tree-shaking</h3><p>通过import 语法引入的模块，在生产环境下，会自动去掉没用到的代码，这就是tree-shking,require不支持</p>
<p> <a href="https://juejin.im/post/5a4dc842518825698e7279a9" target="_blank" rel="noopener">Tree-Shaking性能优化实践-原理篇</a></p>
<p><a href="https://juejin.im/post/5a4dca1d518825128654fa78" target="_blank" rel="noopener">Tree-Shaking性能优化实践 - 实践篇</a></p>
<p><a href="http://blog.ctomorrow.top/2019/02/15/tree-shaking/" target="_blank" rel="noopener">Webpack4:Tree-shaking深度解析</a></p>
<h3 id="scope-hosting"><a href="#scope-hosting" class="headerlink" title="scope hosting"></a>scope hosting</h3><p>作用域提升，可以自动省略，可以简化的代码</p>
<p><a href="https://zhuanlan.zhihu.com/p/27980441" target="_blank" rel="noopener">Webpack 3 的新功能：Scope Hoisting</a></p>
<h2 id="splitChunks"><a href="#splitChunks" class="headerlink" title="splitChunks"></a>splitChunks</h2><p>将公共部分代码单独抽离出来引用</p>
<p><a href="http://blog.ctomorrow.top/2019/02/15/tree-shaking/" target="_blank" rel="noopener">理解webpack4.splitChunks</a></p>
<p><a href="https://imweb.io/topic/5b66dd601402769b60847149" target="_blank" rel="noopener">webpack 4 Code Splitting 的 splitChunks 配置探索</a></p>
<h2 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h2><p>通过 es6 的 import 语法动态的导入 需要引入的文件</p>
<p>需要安装插件 <code>@babel/plugin-syntax-dynamic-import</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.js$/</span>，</span><br><span class="line">                use:&#123;</span><br><span class="line">                    loader:<span class="string">'babel-loader'</span>,</span><br><span class="line">                    options:&#123;</span><br><span class="line">                        presets:[</span><br><span class="line">                            <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">                            <span class="string">'@babel/preset-react'</span></span><br><span class="line">                        ],</span><br><span class="line">                        plugins:[</span><br><span class="line">                            <span class="string">'@babel/plugin-syntax-dynamic-import'</span></span><br><span class="line">                        ]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">'./index.js'</span>).then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data.default)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>打包之后发现，webapck将动态引入的文件打包成了 1.js </p>
<h2 id="热更新"><a href="#热更新" class="headerlink" title="热更新"></a>热更新</h2><p>文件更新之后，不会刷新页面，起到部分刷新的作用</p>
<p>需要两个步骤：</p>
<ul>
<li>使用 HotModuleReplacementPlugin 插件</li>
<li>打开 webpack-dev-server 的热更新开关</li>
</ul>
<p>Webpack 的热更新，其实只是提供一套接口和基础的模块替换的实现。作为开发者，需要在代码中通过热更新接口（module.hot.xxx）向 Webpack 声明依赖模块和当前模块是否能够更新，以及更新的前后进行的处理。</p>
<p>如果接受更新，那么需要开发者自己来在模块被替换前清理或保留必要的数据、状态，并在模块被替换后恢复之前的数据、状态。</p>
</div></article></div><div class="right-container"><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">搜索</label></div><div id="search_result" class="search-result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"><a href="/2019/12/01/typescript学习/" title="typescript学习" class="prev">PREV</a><a href="/2017/04/23/jQuery学习笔记/" title="jQuery使用总结" class="next">NEXT</a></div><div class="copyright"><p>©<a target="_blank">LongTean</a><span style="padding-right: 6px;"> </span></p></div><div class="totop"><i></i></div></div></footer><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="https://bubuzou.oss-cn-shenzhen.aliyuncs.com/blog/202010/jquery-1.8.2.min.js"></script><script src="https://bubuzou.oss-cn-shenzhen.aliyuncs.com/blog/202010/articleCatalog.js"></script><script src="https://bubuzou.oss-cn-shenzhen.aliyuncs.com/blog/202010/main.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>